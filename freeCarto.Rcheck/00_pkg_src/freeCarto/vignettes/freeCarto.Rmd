---
title: "How to use the freeCarto package"
output:
  html_document:
    fig_height: 7
  pdf_document:
  - default
encoding: UTF-8
---

<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{How to use the freeCarto package}
\usepackage[utf8]{inputenc}
-->

**This is a thematic mapping package.**    
Example proposed here use data inbedded within the package.

## Package's functions
* StaticMap to add layers on a map
* LayoutMap to make a nice frame around a map
* SymbolsMap to add a symbols layer on a map
* OSMMap to add an OSM layer on a map
* LabelMap to add labels on a map

## How to use the functions
The aim of this example is to create a map of the Tunisian population.

### StaticMap
Lets start to plot a base map layer of the Tunisian delegations.

```{r }
library(freeCarto)
# load the data
data("TNdeleg")
# This dataset contains a data.frame and a SpatialPolygonsDataFrame 
# of the tunisian delegations
?TNdeleg
?TNdeleg.spdf
# The StaticMap function allows to plot a Spatial*DataFrame
StaticMap(obj = TNdeleg.spdf, col = "#04233B", border = "#295170", lwd = 0.75, 
          add = FALSE)

```

### SymbolsMap
Then we can add the symbols on the map. We use the "pop_t" variable (total population).  
The SymbolsMap function needs a SpatialPointsDataFrame or a SpatialPolygonsDataFrame and a data.frame.  
To establish the link between these two objects objid and dataid can be used.  
If no objid is provided the first column of the data.frame of the sp object is used.  
if no dataid is provided the first column of the data.frame is used.  

```{r }
StaticMap(obj = TNdeleg.spdf, col = "#04233B", border = "#295170", lwd = 0.75, 
          add = FALSE)
SymbolsMap(obj = TNdeleg.spdf, data = TNdeleg, datavar = "pop_t", 
           title = "Total Population", 
           pos = "topleft", add = TRUE, symbols = "circles", k = 0.2, 
           col = "#469372")
```

### LayoutMap
With every map come a title, a scale, a north arrow, an author and a source.
The LayoutMap function was made for this

```{r }
par(mar = c(0,0,1.25,0))
StaticMap(obj = TNdeleg.spdf, col = "#04233B", border = "#295170", lwd = 0.75,
          add = FALSE)
SymbolsMap(obj = TNdeleg.spdf, data = TNdeleg, datavar = "pop_t", 
           title = "Total Population", 
           pos = "left", add = TRUE, symbols = "circles", k = 0.2, 
           col = "#469372")
LayoutMap(title = "Population distribution in Tunisia, 2004", 
          sources = "INS - Tunisia, General census of population and housing 2004.",
          col = "#003F24", txtcol = "white",
          author = "Timothée Giraud, 2015",scale = 100, frame = TRUE, 
          north = TRUE )
```

### OSMMap
It can be nice to have a raster base map in the background af a map. This function is based on the OpenStreetMap package...

```{r }
OSMMap(obj = TNdeleg.spdf, type = "osm", add = FALSE)
SymbolsMap(obj = TNdeleg.spdf, data = TNdeleg, datavar = "pop_t", 
           title = "Total Population", 
           pos = "left", add = TRUE, symbols = "circles", k = 0.2, 
           col = "#469372")
LayoutMap(title = "Population distribution in Tunisia, 2004", 
          sources = "INS - Tunisia, General census of population and housing 2004.",
          col = "#003F24", 
          txtcol = "white",
          author = "Timothée Giraud, 2015",scale = 100, frame = TRUE, 
          north = TRUE )
```

Beside OSM other basemaps are available ("osm", "osm-bw", "maptoolkit-topo", "waze", "mapquest", "mapquest-aerial", "bing", "stamen-toner", "stamen-terrain", "stamen-watercolor", "osm-german", "osm-wanderreitkarte", "mapbox", "esri", "esri-topo", "nps", "apple-iphoto", "skobbler", "cloudmade-<id>", "hillshade", "opencyclemap", "osm-transport", "osm-public-transport", "osm-bbike", "osm-bbike-german").  

### LabelMap
It is possible to plot labels on the map
```{r }
data("FRdep")
# Selection of departments from the Midi-Pyrenées region
MP <- FRdep.spdf[FRdep.spdf@data$dep_code %in% 
                   c("09", "12", "31", "32", "46", "65", "81", "82" ),]
OSMMap(obj = MP, type = "stamen-watercolor", add = FALSE)
StaticMap(obj = MP, col = NA, border = "red", lwd = 1.25, add = TRUE)
SymbolsMap(obj = MP, data = FRdep, datavar = "ptota_2011", 
           title = "Total Population", pos = "topleft", add = TRUE, 
           symbols = "circles", k = 0.05, col = "#469372")
LabelMap(obj = MP, objid = "dep_code", data = FRdep, dataid = "dep_code",
         cex = 0.6, txt = "dep_name", col = "black")
LayoutMap(title = "Population Distribution in Midi-Pyrénées", 
          sources = "INSEE 2011", col = "#003F24", 
          txtcol = "white",
          author = "Timothée Giraud, 2015",scale = 100, frame = TRUE, 
          north = TRUE )

```

